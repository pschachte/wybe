type combined(T) {
    pub combined(x: T, y: list(T), z: list(T))
}

# we expect that after optimization, the appends should write
# *directly* into the combined structure
pub def appendstuff(l: list(int), l2: list(int), ?result: combined(int)) {
    ?l3 = l ,, l2
    ?l4 = l2 ,, l
    ?len = length(l) + length(l2)
    ?result = combined(len, l3, l4)
}

appendstuff([1,2,3], [4,5,6], ?l2)
!println(combined.x(l2))
!println(print, combined.y(l2))
!println(print, combined.z(l2))